---
title: "p8105_hw5_yz4993"
author: "Yixin Zheng"
date: "`r Sys.Date()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
```

#Problem 1
```{r p1_create function}
simulate_birthday <- function(n) {
  birthdays <- sample(1:365, n, replace = TRUE) # assign random birthdays
  any(duplicated(birthdays)) # check for duplicate birthdays
  }
```

```{r p1_parameters}
set.seed(42)
sizes <- 2:50
num_of_times <- 10000
```

```{r p1_simulation}
results <- tibble(
  group_size = sizes,
  probability = map_dbl(sizes, function(n) {
    mean(replicate(num_of_times, simulate_birthday(n)))
  })
)

# another method:
# sim_results_df <- expand_grid(group_size = 2:50, iter = 1:10000) |> mutate(has_shared_birthday = map_lgl(group_size, simulate_birthday)) |> group_by(group_size) |> summarize(probability = mean(has_shared_birthday), .groups = "drop")
```

```{r p1_plot}
results %>%
  ggplot(aes(x = group_size, y = probability)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Probability of Shared Birthday in a Group",
    x = "Number of People in Group",
    y = "Probability"
  ) +
  theme_minimal(base_size = 14)
```

The plot above shows that as the group size increases, the probability of that at least two people in the group will share a birthday also increase. Around group size of 23,the probability exceeds 0.5(50%), and in group of 50 people, the probability is very close to 1(100%). Meaning

